<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="Shift_JIS">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>検索機能付きテーブルとコピーボタン</title>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            loadCSV('smartpbx.csv', 'smartpbxTableBody');
            loadCSV('sansan.csv', 'sansanTableBody');
        });
        
        function loadCSV(csvFile, tableId) {
            fetch(csvFile)
                .then(response => response.text())
                .then(text => {
                    const rows = text.split('\n').map(row => row.split(','));
                    const tableBody = document.getElementById(tableId);
                    tableBody.innerHTML = '';
                    rows.forEach(cells => {
                        if (cells.length < 4) return;
                        const tr = document.createElement('tr');
                        cells.forEach(cell => {
                            const td = document.createElement('td');
                            td.textContent = cell;
                            tr.appendChild(td);
                        });
                        tableBody.appendChild(tr);
                    });
                });
        }
        
        function searchTable() {
            const searchTerm = document.getElementById('searchBox').value.trim();
            searchAndDisplay(searchTerm, 'smartpbxTableBody', 'smartpbxResult');
            searchAndDisplay(searchTerm, 'sansanTableBody', 'sansanResult');
        }
        
        function searchAndDisplay(searchTerm, tableId, resultId) {
            const tableBody = document.getElementById(tableId);
            const rows = tableBody.getElementsByTagName('tr');
            const resultContainer = document.getElementById(resultId);
            resultContainer.innerHTML = '';
            
            for (let row of rows) {
                if (row.cells[0].textContent === searchTerm) {
                    resultContainer.innerHTML = `<div>${row.cells[1].textContent} <button onclick="copyText('${row.cells[1].textContent}')">コピー</button></div>
                                                <div>${row.cells[2].textContent} <button onclick="copyText('${row.cells[2].textContent}')">コピー</button></div>
                                                <div>${row.cells[3].textContent} <button onclick="copyText('${row.cells[3].textContent}')">コピー</button></div>`;
                    return;
                }
            }
            resultContainer.innerHTML = '検索結果なし';
        }
        
        function copyText(text) {
            navigator.clipboard.writeText(text).then(() => alert('コピーしました: ' + text));
        }
        
        function clearTables() {
            document.getElementById('smartpbxTableBody').innerHTML = '';
            document.getElementById('sansanTableBody').innerHTML = '';
        }
    </script>
</head>
<body>
    <h1>検索機能付きテーブルとコピーボタン</h1>
    <input type="text" id="searchBox" placeholder="IDを入力">
    <button onclick="searchTable()">検索</button>
    <button onclick="clearTables()">クリア</button>
    
    <h2>SmartPBX テーブル</h2>
    <table border="1">
        <thead><tr><th>ID</th><th>ユーザ名</th><th>パスワード</th><th>コード</th></tr></thead>
        <tbody id="smartpbxTableBody"></tbody>
    </table>
    
    <h2>Sansan テーブル</h2>
    <table border="1">
        <thead><tr><th>ID</th><th>ユーザ名</th><th>パスワード</th><th>コード</th></tr></thead>
        <tbody id="sansanTableBody"></tbody>
    </table>
    
    <h2>SmartPBX 検索結果</h2>
    <div id="smartpbxResult"></div>
    
    <h2>Sansan 検索結果</h2>
    <div id="sansanResult"></div>
</body>
</html>
