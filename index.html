<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="Shift_JIS">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>検索機能付きテーブルとコピーボタン</title>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            let smartPBXData = [];
            let sansanData = [];
            
            function loadCSV(file, callback) {
                fetch(file)
                    .then(response => response.text())
                    .then(text => {
                        const rows = text.split("\n").map(row => row.split(","));
                        callback(rows);
                    })
                    .catch(error => console.error("CSV読み込みエラー:", error));
            }
            
            function populateTable(tableId, data) {
                const tbody = document.getElementById(tableId);
                tbody.innerHTML = "";
                data.forEach(row => {
                    let tr = document.createElement("tr");
                    row.forEach(cell => {
                        let td = document.createElement("td");
                        td.textContent = cell;
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                });
            }
            
            document.getElementById("clearBtn").addEventListener("click", function() {
                document.getElementById("searchBox").value = "";
                document.getElementById("smartPBXUser").textContent = "";
                document.getElementById("smartPBXPass").textContent = "";
                document.getElementById("smartPBXCode").textContent = "";
                document.getElementById("sansanUser").textContent = "";
                document.getElementById("sansanPass").textContent = "";
                document.getElementById("sansanCode").textContent = "";
            });
            
            document.getElementById("searchBtn").addEventListener("click", function() {
                const searchTerm = document.getElementById("searchBox").value.trim();
                if (!searchTerm) {
                    alert("IDを入力してください。");
                    return;
                }
                
                function searchData(data, resultContainer) {
                    const result = data.find(row => row[0] === searchTerm);
                    if (result) {
                        document.getElementById(resultContainer + "User").textContent = result[1] || "";
                        document.getElementById(resultContainer + "Pass").textContent = result[2] || "";
                        document.getElementById(resultContainer + "Code").textContent = result[3] || "";
                    } else {
                        alert("該当データが見つかりません。");
                    }
                }
                
                searchData(smartPBXData, "smartPBX");
                searchData(sansanData, "sansan");
            });
            
            function copyText(elementId) {
                const text = document.getElementById(elementId).textContent;
                if (text) {
                    navigator.clipboard.writeText(text).then(() => {
                        alert("コピーしました！");
                    }).catch(err => console.error("コピー失敗:", err));
                } else {
                    alert("コピーする内容がありません。");
                }
            }
            
            loadCSV("smartPBX.csv", data => {
                smartPBXData = data;
                populateTable("smartPBXTable", data);
            });
            
            loadCSV("sansan.csv", data => {
                sansanData = data;
                populateTable("sansanTable", data);
            });
        });
    </script>
</head>
<body>
    <input type="text" id="searchBox" placeholder="IDを入力して検索...">
    <button id="searchBtn">検索</button>
    <button id="clearBtn">クリア</button>
    
    <h2>SmartPBX テーブル</h2>
    <table border="1">
        <thead><tr><th>ID</th><th>ユーザ名</th><th>パスワード</th><th>コード</th></tr></thead>
        <tbody id="smartPBXTable"></tbody>
    </table>
    
    <h2>Sansan テーブル</h2>
    <table border="1">
        <thead><tr><th>ID</th><th>ユーザ名</th><th>パスワード</th><th>コード</th></tr></thead>
        <tbody id="sansanTable"></tbody>
    </table>
    
    <h2>SmartPBX 検索結果</h2>
    <div id="smartPBXResult">
        <div>ユーザ名: <span id="smartPBXUser"></span> <button onclick="copyText('smartPBXUser')">コピー</button></div>
        <div>パスワード: <span id="smartPBXPass"></span> <button onclick="copyText('smartPBXPass')">コピー</button></div>
        <div>コード: <span id="smartPBXCode"></span> <button onclick="copyText('smartPBXCode')">コピー</button></div>
    </div>
    
    <h2>Sansan 検索結果</h2>
    <div id="sansanResult">
        <div>ユーザ名: <span id="sansanUser"></span> <button onclick="copyText('sansanUser')">コピー</button></div>
        <div>パスワード: <span id="sansanPass"></span> <button onclick="copyText('sansanPass')">コピー</button></div>
        <div>コード: <span id="sansanCode"></span> <button onclick="copyText('sansanCode')">コピー</button></div>
    </div>
</body>
</html>
